From c48b76c9167ce2b6375664e0bb3c59a93ac8d7ba Mon Sep 17 00:00:00 2001
From: Mat Booth <mat.booth@gmail.com>
Date: Wed, 12 Nov 2025 16:23:36 +0000
Subject: [PATCH] remove docker tests

---
 tests/conftest.py | 44 --------------------------------------------
 1 file changed, 44 deletions(-)

diff --git a/tests/conftest.py b/tests/conftest.py
index a583254..b01a312 100644
--- a/tests/conftest.py
+++ b/tests/conftest.py
@@ -5,7 +5,6 @@ import time
 import uuid
 from typing import Any, AsyncIterator, Callable, Iterator, TypedDict
 
-import docker as docker_mod
 import memcache
 import pytest
 
@@ -58,9 +57,6 @@ def session_id() -> str:
     return str(uuid.uuid4())
 
 
-@pytest.fixture(scope='session')
-def docker() -> docker_mod.Client:  # type: ignore[no-any-unimported]
-    return docker_mod.from_env()
 
 
 def mcache_server_actual(host: str, port: int = 11211) -> ServerParams:
@@ -72,46 +68,6 @@ def mcache_server_actual(host: str, port: int = 11211) -> ServerParams:
     }
 
 
-@contextlib.contextmanager
-def mcache_server_docker(  # type: ignore[no-any-unimported]
-        unused_port: Callable[[], int], docker: docker_mod.Client, session_id: str
-) -> Iterator[ServerParams]:
-    docker.images.pull("memcached:alpine")
-    container = docker.containers.run(
-        image='memcached:alpine',
-        name='memcached-test-server-{}'.format(session_id),
-        ports={"11211/tcp": None},
-        detach=True,
-    )
-    try:
-        container.start()
-        container.reload()
-        net_settings = container.attrs["NetworkSettings"]
-        host = net_settings["IPAddress"]
-        port = int(net_settings["Ports"]["11211/tcp"][0]["HostPort"])
-        mcache_params: McacheParams = {"host": host, "port": port}
-        delay = 0.001
-        for _i in range(10):
-            try:
-                conn = memcache.Client(["{host}:{port}".format_map(mcache_params)])
-                conn.get_stats()
-                break
-            except Exception:
-                time.sleep(delay)
-                delay *= 2
-        else:
-            pytest.fail("Cannot start memcached")
-        ret: ServerParams = {
-            "Id": container.id,
-            "host": host,
-            "port": port,
-            "mcache_params": mcache_params
-        }
-        time.sleep(0.1)
-        yield ret
-    finally:
-        container.kill()
-        container.remove()
 
 
 @pytest.fixture(scope='session')
-- 
2.51.1

